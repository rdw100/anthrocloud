@using AnthroCloud.Entities
@using AnthroCloud.UI.Wasm.Services
@inject HttpClient httpClient

<FluentTreeView >
    @foreach (Patient Item in patientList)
    {
        <FluentTreeItem >
            <FluentIcon Name="@FluentIcons.PersonNote" Size="IconSize.Size24" Filled=false />
            @Item.FirstName @Item.LastName
            @foreach (Visit Visit in Item.Visits)
            {
                <FluentTreeItem>
                    <FluentIcon Name="@FluentIcons.Ruler" Size="IconSize.Size24" Filled=false />
                    Visit - @Visit.VisitId @Visit.Weight @Visit.LengthHeight
                </FluentTreeItem>
            }
        </FluentTreeItem>
    }
</FluentTreeView>

@code {
    [Inject]
    public IPatientService PatientService { get; set; }
    protected List<Patient> patientList = new();
    protected override async Task OnInitializedAsync()
    {
        await GetPatientsVisits();
    }
    protected async Task GetPatientsVisits()
    {
        patientList = (await PatientService.GetPatientsVisits()).ToList();
    }
}